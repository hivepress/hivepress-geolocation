const attachShadow=Element.prototype.attachShadow;Element.prototype.attachShadow=function(a){if("gmp-place-autocomplete"===this.localName){const b=attachShadow.call(this,{...a,mode:"open"}),c=document.createElement("style");return c.textContent=`

    `,b.appendChild(c),b}return attachShadow.call(this,a)},function(a){"use strict";hivepress.initGeolocation=function(b){b.find(hivepress.getSelector("location")).each(function(){var b=a(this),c=b.closest("form"),d=b.find("input[type=text]"),e=c.find("input[data-coordinate=lat]"),f=c.find("input[data-coordinate=lng]"),g=c.find("input[data-region]"),h=b.find("a"),i={};if("undefined"!=typeof mapboxData){i={accessToken:mapboxData.apiKey,language:hivepressCoreData.language},b.data("countries")&&(i.countries=b.data("countries").join(",")),b.data("types")&&(i.types=b.data("types").join(","));var j=new MapboxGeocoder(i);j.addTo(b.get(0));var k=b.children(".mapboxgl-ctrl"),l=d.prop("attributes");d.remove(),d=k.find("input[type=text]"),a.each(l,function(){d.attr(this.name,this.value)}),k.detach().prependTo(b),j.on("result",function(a){var b=["place","district","region","country"];g.length&&(a.result.place_type.filter(a=>b.includes(a)).length?g.val(a.result.id):g.val("")),f.val(a.result.geometry.coordinates[0]),e.val(a.result.geometry.coordinates[1])})}else{i={name:d.attr("name"),requestedLanguage:hivepressCoreData.language},b.data("countries")&&(i.includedRegionCodes=b.data("countries")),b.data("types")&&(i.includedPrimaryTypes=b.data("types"));const c=new google.maps.places.PlaceAutocompleteElement(i);b.get(0).appendChild(c),console.log(c.shadowRoot.querySelector("input"));var l=d.prop("attributes");d.remove();new MutationObserver(function(b,e){d=a(c.shadowRoot.querySelector("input")),a.each(l,function(){d.attr(this.name,this.value)}),e.disconnect()}).observe(c.shadowRoot,{childList:!0,subtree:!0});c.addEventListener("gmp-select",async({placePrediction:a})=>{const b=a.toPlace();await b.fetchFields({fields:["location"]}),f.val(b.location.lng),e.val(b.location.lat)})}d.on("input",function(){d.val()||c.find("input[data-coordinate]").val("")}),navigator.geolocation?h.on("click",function(a){navigator.geolocation.getCurrentPosition(function(a){"undefined"!=typeof mapboxData&&(j.options.reverseGeocode=!0,j.options.limit=1,j.query(a.coords.latitude+","+a.coords.longitude),j.options.reverseGeocode=!1,j.options.limit=5)}),a.preventDefault()}):h.hide()}),b.find(hivepress.getSelector("map")).each(function(){var b=a(this),c=b.width(),d=b.data("max-zoom"),e=b.data("marker");if(b.is("[data-height]")&&(c=b.data("height")),b.height(c),"undefined"!=typeof mapboxData){mapboxgl.accessToken=mapboxData.apiKey;var f=new mapboxgl.LngLatBounds,g=new mapboxgl.Map({container:b.get(0),style:"mapbox://styles/mapbox/streets-v11",center:[0,0],zoom:1});g.addControl(new mapboxgl.NavigationControl),g.addControl(new mapboxgl.FullscreenControl),g.addControl(new MapboxLanguage),a.each(b.data("markers"),function(a,b){f.extend([b.longitude,b.latitude]);new mapboxgl.Marker().setLngLat([b.longitude,b.latitude]).setPopup(new mapboxgl.Popup().setHTML(b.content)).addTo(g)}),g.fitBounds(f,{maxZoom:d-1,padding:50,duration:0});var h=new ResizeObserver(function(){g.resize(),g.fitBounds(f,{maxZoom:d-1,padding:50,duration:0})}).observe(b.get(0))}else{var i=!1,j=[],f=new google.maps.LatLngBounds,g=new google.maps.Map(b.get(0),{zoom:3,minZoom:2,maxZoom:d,mapTypeControl:!1,streetViewControl:!1,center:{lat:0,lng:0},styles:[{featureType:"poi",stylers:[{visibility:"off"}]}]}),k=new OverlappingMarkerSpiderfier(g,{markersWontMove:!0,markersWontHide:!0,basicFormatEvents:!0}),l={path:google.maps.SymbolPath.CIRCLE,fillColor:"#3a77ff",fillOpacity:.25,strokeColor:"#3a77ff",strokeWeight:1,strokeOpacity:.75,scale:10};a.each(b.data("markers"),function(a,c){var d=new google.maps.InfoWindow({content:c.content}),h={title:c.title,position:{lat:c.latitude,lng:c.longitude}};e&&(h.icon={url:e,scaledSize:new google.maps.Size(50,50)}),b.data("scatter")&&(h.icon=l);var m=new google.maps.Marker(h);m.addListener("spider_click",function(){i&&i.close(),i=d,d.open(g,m)}),j.push(m),k.addMarker(m),f.extend(m.getPosition())}),g.fitBounds(f);var h=new ResizeObserver(function(){g.fitBounds(f)}).observe(b.get(0)),m=new MarkerClusterer(g,j,{imagePath:hivepressGeolocationData.assetURL+"/images/markerclustererplus/m",maxZoom:d-1});b.data("scatter")&&g.addListener("zoom_changed",function(){var b=Math.pow;l.scale=b(1.3125,g.getZoom()),a.each(j,function(a){j[a].setIcon(l)})})}})},a(document).on("hivepress:init",function(a,b){hivepress.initGeolocation(b)})}(jQuery);